(()=>{"use strict";function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},e.apply(this,arguments)}const t=window.wp.element,a=window.wp.blocks,l=window.wp.blockEditor,n=window.wp.i18n,r=window.wp.components;(0,a.registerBlockType)("realads/banner",{title:(0,n.__)("Banner - RealAds","lap-api"),description:(0,n.__)("Add a Banner to your page.","lap-api"),icon:"embed-generic",supports:{reusable:!0,inserter:!0,anchor:!0,align:!0},example:{attributes:{sizeId:"A",autoReload:!0}},attributes:{sizeId:{type:"string",default:"A"},autoReload:{type:"boolean",default:!0}},category:"realads",edit:a=>{let{attributes:i,setAttributes:o}=a;const[s,c]=(0,t.useState)([]),[d,p]=(0,t.useState)(null),[u,m]=(0,t.useState)(!1),g=(0,t.useRef)(null);return(0,t.useEffect)((()=>{m(!0);const e="lap_b_s-editor",t=document.cookie.split("; ").find((t=>t.startsWith(e)));if(t)try{const e=JSON.parse(t.split("=")[1]);c(e),o({sizeId:e[0].id}),m(!1)}catch(e){console.error(e),p(e),m(!1)}else fetch("https://lap-api.com/b/sizes").then((e=>e.json())).then((t=>{c(t),o({sizeId:t[0].id}),document.cookie=`${e}=${JSON.stringify(t)}; max-age=86400; path=/`})).catch((e=>{console.error(e),p(e)})).finally((()=>m(!1)))}),[]),(0,t.useEffect)((()=>{if(!g.current)return;if(!i.sizeId)return;const e=s.filter((e=>e.id===i.sizeId));if(!e.length)return;const t=e[0],{width:a,height:l}=t;g.current.style.width=`${a}px`,g.current.style.height=`${l}px`}),[i.sizeId,g,s]),(0,t.createElement)("div",e({},(0,l.useBlockProps)(),{ref:g,style:{backgroundColor:"#dcf39b",border:"1px solid #e5e5e5",borderRadius:"4px",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",margin:"auto"},className:`lap-banner ${i.className} wp-block`,"data-type":"realads"}),">",(0,t.createElement)(l.BlockControls,null,(0,t.createElement)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",borderLeft:"1px solid black",borderRight:"1px solid black",padding:"5px 10px",gap:"15px"}},(0,t.createElement)(r.DropdownMenu,{style:{height:"100%"},icon:"image-crop",label:(0,n.__)("Banner Size","lap-api"),controls:s.map((e=>({title:`${e.name} (${e.width}px*${e.height}px)`,onClick:()=>o({sizeId:e.id}),isActive:i.sizeId===e.id})))}),(0,t.createElement)("div",{style:{width:"1px",height:"75%",backgroundColor:"black"}}),(0,t.createElement)(r.ToggleControl,{label:(0,n.__)("Auto Reload","lap-api"),checked:i.autoReload,onChange:e=>o({autoReload:e})}))),(0,t.createElement)(l.InspectorControls,null,(0,t.createElement)(r.ToggleControl,{label:(0,n.__)("Auto reload","lap-api"),checked:i.autoReload,onChange:e=>o({autoReload:e})}),(0,t.createElement)(r.SelectControl,{label:(0,n.__)("Select Size","lap-api"),value:i.sizeId,options:s.map((e=>({label:e.name,value:e.id})))||[],onChange:e=>o({sizeId:e})})),u?(0,t.createElement)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},(0,t.createElement)("div",{className:"spinner"})):d?(0,t.createElement)("div",{style:{padding:"10px"}},(0,t.createElement)("p",null,(0,n.__)("Error loading banner sizes","lap-api")),(0,t.createElement)("p",null,d.message)):(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{style:{display:"inline",textAlign:"center",transform:"rotate(350deg)",margin:0,padding:0,color:"brown"}},(0,t.createElement)("h5",{style:{margin:0,userSelect:"none"}},(0,n.__)("Banner Placeholder","lap-api")))))},save:function(a){let{attributes:n}=a;return(0,t.createElement)("div",e({},l.useBlockProps.save(),{"data-lap-b":n.sizeId,"data-lap-b-render":n.autoReload?"auto":"manual",className:`lap-banner ${n.className}`,style:{position:"relative"}}),null)}})})();